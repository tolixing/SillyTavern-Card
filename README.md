# SillyTavern è§’è‰²å¡ä¸­å¿ƒ

ä¸€ä¸ªç°ä»£åŒ–çš„è§’è‰²å¡ç®¡ç†å¹³å°ï¼Œä¸“ä¸º SillyTavern ç”¨æˆ·è®¾è®¡ã€‚æ”¯æŒè§’è‰²å¡çš„ä¸Šä¼ ã€ç®¡ç†ã€ç¼–è¾‘å’Œåˆ†äº«ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ­ è§’è‰²å¡ç®¡ç†
- **æ™ºèƒ½ä¸Šä¼ **ï¼šæ”¯æŒ PNG æ ¼å¼è§’è‰²å¡ï¼Œè‡ªåŠ¨è§£æå…ƒæ•°æ®ä¿¡æ¯
- **å¯è§†åŒ–å±•ç¤º**ï¼šç¾è§‚çš„å¡ç‰‡å¼å¸ƒå±€ï¼Œå…¨å›¾èƒŒæ™¯å±•ç¤º
- **ä¸€é”®ç¼–è¾‘**ï¼šå¼¹çª—å¼ç¼–è¾‘ç•Œé¢ï¼Œæ”¯æŒä¿¡æ¯ä¿®æ”¹å’Œæ–‡ä»¶æ›¿æ¢
- **æ‰¹é‡æ“ä½œ**ï¼šæ”¯æŒè§’è‰²å¡çš„åˆ é™¤å’Œæ‰¹é‡ç®¡ç†

### ğŸ¨ ç”¨æˆ·ç•Œé¢
- **ç°ä»£åŒ–è®¾è®¡**ï¼šé‡‡ç”¨ Tailwind CSSï¼Œå“åº”å¼å¸ƒå±€
- **åŠ¨æ€æ¨¡ç³Šæ•ˆæœ**ï¼šåº•éƒ¨ä¿¡æ¯åŒºåŸŸä½¿ç”¨æ¸å˜èƒŒæ™¯å’Œæ¨¡ç³Šæ•ˆæœ
- **æµç•…åŠ¨ç”»**ï¼šæ‚¬åœæ”¾å¤§ã€è¿‡æ¸¡åŠ¨ç”»ç­‰äº¤äº’æ•ˆæœ
- **å¼¹çª—äº¤äº’**ï¼šä¸Šä¼ ã€ç¼–è¾‘ã€è¯¦æƒ…æŸ¥çœ‹å‡é‡‡ç”¨å¼¹çª—æ¨¡å¼

### ğŸ” æœç´¢å’Œç­›é€‰
- **å®æ—¶æœç´¢**ï¼šæ”¯æŒæŒ‰è§’è‰²åç§°ã€æè¿°ã€æ ‡ç­¾æœç´¢
- **è¯¦æƒ…æŸ¥çœ‹**ï¼šç‚¹å‡»è§’è‰²å¡æŸ¥çœ‹å®Œæ•´ä¿¡æ¯
- **ç‰ˆæœ¬ç®¡ç†**ï¼šæ˜¾ç¤ºè§’è‰²å¡ç‰ˆæœ¬ä¿¡æ¯

### ğŸ“± å“åº”å¼æ”¯æŒ
- **å¤šç«¯é€‚é…**ï¼šæ”¯æŒæ¡Œé¢ç«¯ã€å¹³æ¿ã€æ‰‹æœºç­‰ä¸åŒå±å¹•å°ºå¯¸
- **è§¦æ§å‹å¥½**ï¼šä¼˜åŒ–è§¦æ§è®¾å¤‡çš„äº¤äº’ä½“éªŒ

## ğŸš€ æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**ï¼šNext.js 15 (App Router)
- **UI æ¡†æ¶**ï¼šTailwind CSS 4
- **å¼€å‘è¯­è¨€**ï¼šTypeScript
- **å›¾åƒå¤„ç†**ï¼šSharp (Next.js Image ä¼˜åŒ–)
- **æ„å»ºå·¥å…·**ï¼šTurbopack
- **å®¹å™¨åŒ–**ï¼šDocker & Docker Compose
- **åå‘ä»£ç†**ï¼šNginx

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 18+ 
- Docker & Docker Compose
- npm æˆ– yarn æˆ– pnpm

### æœ¬åœ°å¼€å‘

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <your-repository-url>
cd SillyTavern-Card
```

2. **å®‰è£…ä¾èµ–**
```bash
npm install
# æˆ–
yarn install
# æˆ–
pnpm install
```

3. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
```bash
npm run dev
# æˆ–
yarn dev
# æˆ–
pnpm dev
```

4. **è®¿é—®åº”ç”¨**
æ‰“å¼€æµè§ˆå™¨è®¿é—® [http://localhost:3000](http://localhost:3000)

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
npm start
```

## ğŸ³ Docker éƒ¨ç½²

### å¿«é€Ÿå¼€å§‹

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/tolixing/SillyTavern-Card.git
cd sillytavern-card
```

2. **ä½¿ç”¨é¢„æ„å»ºé•œåƒå¯åŠ¨æœåŠ¡**
```bash
# ç›´æ¥ä½¿ç”¨é¢„æ„å»ºé•œåƒå¯åŠ¨
docker-compose up -d
```

3. **è®¿é—®åº”ç”¨**
- åº”ç”¨åœ°å€ï¼šhttp://localhost:3000

### ç®¡ç†å‘½ä»¤

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down

# é‡å¯æœåŠ¡
docker-compose restart

# æ›´æ–°æœåŠ¡
docker-compose pull && docker-compose up -d
```

### æ•°æ®æŒä¹…åŒ–

é¡¹ç›®æ•°æ®ä¼šä¿å­˜åœ¨ä»¥ä¸‹ç›®å½•ï¼š
- `./data/` - åº”ç”¨æ•°æ®
- `./public/characters/` - è§’è‰²å¡æ–‡ä»¶

### è¯¦ç»†ä½¿ç”¨è¯´æ˜

æ›´å¤š Docker ä½¿ç”¨è¯´æ˜è¯·å‚è€ƒï¼š[Docker ä½¿ç”¨æŒ‡å—](./doc/docker-usage.md)

## ğŸ“ é¡¹ç›®ç»“æ„

```
sillytavern-card/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ components/          # React ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ UploadModal.tsx  # ä¸Šä¼ å¼¹çª—
â”‚   â”‚   â”‚   â””â”€â”€ EditModal.tsx    # ç¼–è¾‘å¼¹çª—
â”‚   â”‚   â”œâ”€â”€ api/                 # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ upload/          # ä¸Šä¼  API
â”‚   â”‚   â”‚   â”œâ”€â”€ characters/      # è§’è‰²ç®¡ç† API
â”‚   â”‚   â”‚   â”œâ”€â”€ files/           # æ–‡ä»¶æœåŠ¡ API
â”‚   â”‚   â”‚   â””â”€â”€ index/           # ç´¢å¼• API
â”‚   â”‚   â”œâ”€â”€ lib/                 # å·¥å…·åº“
â”‚   â”‚   â”‚   â””â”€â”€ storage.ts       # å­˜å‚¨é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ globals.css          # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ layout.tsx           # æ ¹å¸ƒå±€
â”‚   â”‚   â””â”€â”€ page.tsx             # ä¸»é¡µé¢
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ characters/              # è§’è‰²å¡æ–‡ä»¶å­˜å‚¨
â”‚   â””â”€â”€ index.json               # è§’è‰²ç´¢å¼•æ–‡ä»¶
â”œâ”€â”€ .github/workflows/           # GitHub Actions
â”‚   â””â”€â”€ docker-build.yml         # Docker æ„å»ºå·¥ä½œæµ
â”œâ”€â”€ doc/                         # æ–‡æ¡£
â”œâ”€â”€ data/                        # æ•°æ®ç›®å½•ï¼ˆDocker éƒ¨ç½²ï¼‰
â”œâ”€â”€ docker-compose.yml           # Docker Compose é…ç½®
â”œâ”€â”€ Dockerfile                   # Docker é•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ package.json
â”œâ”€â”€ next.config.ts               # Next.js é…ç½®
â””â”€â”€ tsconfig.json                # TypeScript é…ç½®
```

## ğŸ”§ é…ç½®è¯´æ˜

### Next.js é…ç½®

é¡¹ç›®ä½¿ç”¨ Next.js 15 çš„ App Routerï¼Œæ”¯æŒï¼š
- æœåŠ¡ç«¯æ¸²æŸ“ (SSR)
- é™æ€ç”Ÿæˆ (SSG)
- API è·¯ç”±
- å›¾åƒä¼˜åŒ–
- ç‹¬ç«‹è¾“å‡ºæ¨¡å¼ï¼ˆDocker éƒ¨ç½²ï¼‰

### Docker é…ç½®

- **å¤šé˜¶æ®µæ„å»º**ï¼šä¼˜åŒ–é•œåƒå¤§å°
- **é root ç”¨æˆ·**ï¼šæé«˜å®‰å…¨æ€§
- **æ•°æ®æŒä¹…åŒ–**ï¼šä½¿ç”¨å·æŒ‚è½½
- **é¢„æ„å»ºé•œåƒ**ï¼šä½¿ç”¨ GitHub Container Registry

## ğŸ“– API æ–‡æ¡£

### è§’è‰²å¡ä¸Šä¼ 
```
POST /api/upload
Content-Type: multipart/form-data

å‚æ•°ï¼š
- file: PNG æ ¼å¼çš„è§’è‰²å¡æ–‡ä»¶
- name: è§’è‰²åç§°
- version: ç‰ˆæœ¬å·
- description: æè¿°ä¿¡æ¯
```

### è§’è‰²å¡ç®¡ç†
```
PUT /api/characters/[id]     # æ›´æ–°è§’è‰²å¡
DELETE /api/characters/[id]  # åˆ é™¤è§’è‰²å¡
```

### è§’è‰²ç´¢å¼•
```
GET /api/index               # è·å–æ‰€æœ‰è§’è‰²å¡åˆ—è¡¨
```

### æ–‡ä»¶æœåŠ¡
```
GET /api/files/[...path]     # è·å–è§’è‰²å¡æ–‡ä»¶
```

è¯¦ç»† API æ–‡æ¡£è¯·å‚è€ƒï¼š[API_DOC.md](./API_DOC.md)

## ğŸ”’ å®‰å…¨è€ƒè™‘

### æ–‡ä»¶ä¸Šä¼ å®‰å…¨
- æ–‡ä»¶ç±»å‹éªŒè¯ï¼ˆä»… PNGï¼‰
- æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆ50MBï¼‰
- è·¯å¾„éå†é˜²æŠ¤
- æ¶æ„æ–‡ä»¶æ£€æµ‹

### è®¿é—®æ§åˆ¶
- API è¯·æ±‚é¢‘ç‡é™åˆ¶
- æ–‡ä»¶è®¿é—®æƒé™æ§åˆ¶
- æ•æ„Ÿä¿¡æ¯ä¿æŠ¤

### æ•°æ®å¤‡ä»½
- å®šæœŸè‡ªåŠ¨å¤‡ä»½
- å¢é‡å¤‡ä»½ç­–ç•¥
- å¼‚åœ°å¤‡ä»½æ–¹æ¡ˆ

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **åº”ç”¨æ— æ³•å¯åŠ¨**
   ```bash
   # æ£€æŸ¥ Docker æœåŠ¡çŠ¶æ€
   docker-compose ps
   
   # æŸ¥çœ‹é”™è¯¯æ—¥å¿—
   docker-compose logs app
   ```

2. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**
   - æ£€æŸ¥æ–‡ä»¶å¤§å°æ˜¯å¦è¶…è¿‡é™åˆ¶
   - ç¡®è®¤æ–‡ä»¶æ ¼å¼ä¸º PNG
   - æ£€æŸ¥ç£ç›˜ç©ºé—´æ˜¯å¦å……è¶³

3. **å›¾ç‰‡æ— æ³•æ˜¾ç¤º**
   - æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤æ–‡ä»¶æœåŠ¡ API æ˜¯å¦æ­£å¸¸
   - æ£€æŸ¥æ•°æ®ç›®å½•æƒé™

4. **æ€§èƒ½é—®é¢˜**
   - æ£€æŸ¥æœåŠ¡å™¨èµ„æºä½¿ç”¨æƒ…å†µ
   - æ£€æŸ¥ç£ç›˜ç©ºé—´
   - è€ƒè™‘ä½¿ç”¨ CDN

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker-compose logs -f app

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker-compose logs --tail=100 -f
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [Next.js](https://nextjs.org/) - React æ¡†æ¶
- [Tailwind CSS](https://tailwindcss.com/) - CSS æ¡†æ¶
- [Docker](https://www.docker.com/) - å®¹å™¨åŒ–å¹³å°
- [SillyTavern](https://github.com/SillyTavern/SillyTavern) - è§’è‰²å¡æ ¼å¼æ ‡å‡†

---

**ğŸŒŸ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Starï¼**